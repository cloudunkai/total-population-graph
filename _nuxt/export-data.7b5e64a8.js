function St(H,d){for(var I=0;I<d.length;I++){const f=d[I];if(typeof f!="string"&&!Array.isArray(f)){for(const b in f)if(b!=="default"&&!(b in H)){const a=Object.getOwnPropertyDescriptor(f,b);a&&Object.defineProperty(H,b,a.get?a:{enumerable:!0,get:()=>f[b]})}}}return Object.freeze(Object.defineProperty(H,Symbol.toStringTag,{value:"Module"}))}var it={},Ot={get exports(){return it},set exports(H){it=H}};(function(H){(function(d){H.exports?(d.default=d,H.exports=d):d(typeof Highcharts<"u"?Highcharts:void 0)})(function(d){function I(f,b,a,M){f.hasOwnProperty(b)||(f[b]=M.apply(null,a),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:b,module:f[b]}})))}d=d?d._modules:{},I(d,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:`
`},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table"}}}),I(d,"Extensions/DownloadURL.js",[d["Core/Globals.js"]],function(f){var b=f.isSafari,a=f.win,M=a.document,z=a.URL||a.webkitURL||a,_=f.dataURLtoBlob=function(s){if((s=s.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<s.length&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&a.Blob&&z.createObjectURL){var P=a.atob(s[3]),E=new a.ArrayBuffer(P.length);E=new a.Uint8Array(E);for(var S=0;S<E.length;++S)E[S]=P.charCodeAt(S);return s=new a.Blob([E],{type:s[1]}),z.createObjectURL(s)}};return f=f.downloadURL=function(s,P){var E=a.navigator,S=M.createElement("a");if(typeof s=="string"||s instanceof String||!E.msSaveOrOpenBlob){if(s="".concat(s),E=/Edge\/\d+/.test(E.userAgent),(b&&typeof s=="string"&&s.indexOf("data:application/pdf")===0||E||2e6<s.length)&&(s=_(s)||"",!s))throw Error("Failed to convert to blob");if(typeof S.download<"u")S.href=s,S.download=P,M.body.appendChild(S),S.click(),M.body.removeChild(S);else try{var Q=a.open(s,"chart");if(typeof Q>"u"||Q===null)throw Error("Failed to open window")}catch{a.location.href=s}}else E.msSaveOrOpenBlob(s,P)},{dataURLtoBlob:_,downloadURL:f}}),I(d,"Extensions/ExportData/ExportData.js",[d["Core/Renderer/HTML/AST.js"],d["Extensions/ExportData/ExportDataDefaults.js"],d["Core/Globals.js"],d["Core/Defaults.js"],d["Extensions/DownloadURL.js"],d["Core/Series/SeriesRegistry.js"],d["Core/Utilities.js"]],function(f,b,a,M,z,_,s){function P(){var t=this.getCSV(!0);ht(dt(t,"text/csv")||"data:text/csv,\uFEFF"+encodeURIComponent(t),this.getFilename()+".csv")}function E(){var t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+this.getTable(!0)+"</body></html>";ht(dt(t,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+V.btoa(unescape(encodeURIComponent(t))),this.getFilename()+".xls")}function S(t){var r="",o=this.getDataRows(),i=this.options.exporting.csv,l=U(i.decimalPoint,i.itemDelimiter!==","&&t?1.1 .toLocaleString()[1]:"."),n=U(i.itemDelimiter,l===","?";":","),x=i.lineDelimiter;return o.forEach(function(D,v){for(var c,B=D.length;B--;)c=D[B],typeof c=="string"&&(c='"'+c+'"'),typeof c=="number"&&l!=="."&&(c=c.toString().replace(".",l)),D[B]=c;D.length=o.length?o[0].length:0,r+=D.join(n),v<o.length-1&&(r+=x)}),r}function Q(t){var r=this.hasParallelCoordinates,o=this.time,i=this.options.exporting&&this.options.exporting.csv||{},l=this.xAxis,n={},x=[],D=[],v=[],c=this.options.lang.exportData,B=c.categoryHeader,nt=c.categoryDatetimeHeader,L=function(e,g,y){if(i.columnHeaderFormatter){var F=i.columnHeaderFormatter(e,g,y);if(F!==!1)return F}return e?e instanceof bt?t?{columnTitle:1<y?g:e.name,topLevelColumnTitle:e.name}:e.name+(1<y?" ("+g+")":""):e.options.title&&e.options.title.text||(e.dateTime?nt:B):B},h=function(e,g,y){var F={},X={};return g.forEach(function(K){var R=(e.keyToAxis&&e.keyToAxis[K]||K)+"Axis";R=Et(y)?e.chart[R][y]:e[R],F[K]=R&&R.categories||[],X[K]=R&&R.dateTime}),{categoryMap:F,dateTimeValueAxisMap:X}},w=function(e,g){return e.data.filter(function(y){return typeof y.y<"u"&&y.name}).length&&g&&!g.categories&&!e.keyToAxis?e.pointArrayMap&&e.pointArrayMap.filter(function(y){return y==="x"}).length?(e.pointArrayMap.unshift("x"),e.pointArrayMap):["x","y"]:e.pointArrayMap||["y"]},k=[],p,j=0;this.series.forEach(function(e){var g=e.xAxis,y=e.options.keys||w(e,g),F=y.length,X=!e.requireSorting&&{},K=l.indexOf(g),R=h(e,y),N;if(e.options.includeInDataExport!==!1&&!e.options.isInternal&&e.visible!==!1){for(Tt(k,function(C){return C[0]===K})||k.push([K,j]),N=0;N<F;)p=L(e,y[N],y.length),v.push(p.columnTitle||p),t&&D.push(p.topLevelColumnTitle||p),N++;var ot={chart:e.chart,autoIncrement:e.autoIncrement,options:e.options,pointArrayMap:e.pointArrayMap,index:e.index};e.options.data.forEach(function(C,W){var q={series:ot};r&&(R=h(e,y,W)),e.pointClass.prototype.applyOptions.apply(q,[C]);var m=q.x;for(at(n[m])&&n[m].seriesIndices.includes(ot.index)&&(C=Object.keys(n).filter(function(lt){return n[lt].seriesIndices.includes(ot.index)&&m}).filter(function(lt){return lt.indexOf(String(m))===0}),m=m.toString()+","+C.length),C=e.data[W]&&e.data[W].name,N=0,(!g||e.exportKey==="name"||!r&&g&&g.hasNames&&C)&&(m=C),X&&(X[m]&&(m+="|"+W),X[m]=!0),n[m]||(n[m]=[],n[m].xValues=[]),n[m].x=q.x,n[m].name=C,n[m].xValues[K]=q.x,at(n[m].seriesIndices)||(n[m].seriesIndices=[]),n[m].seriesIndices=Y(Y([],n[m].seriesIndices,!0),[ot.index],!1);N<F;)W=y[N],C=q[W],n[m][j+N]=U(R.categoryMap[W][C],R.dateTimeValueAxisMap[W]?o.dateFormat(i.dateFormat,C):null,C),N++}),j+=N}});for(G in n)Object.hasOwnProperty.call(n,G)&&x.push(n[G]);for(c=t?[D,v]:[v],j=k.length;j--;){var u=k[j][0],O=k[j][1],A=l[u];x.sort(function(e,g){return e.xValues[u]-g.xValues[u]});var G=L(A);c[0].splice(O,0,G),t&&c[1]&&c[1].splice(O,0,G),x.forEach(function(e){var g=e.name;A&&!at(g)&&(A.dateTime?(e.x instanceof Date&&(e.x=e.x.getTime()),g=o.dateFormat(i.dateFormat,e.x)):g=A.categories?U(A.names[e.x],A.categories[e.x],e.x):e.x),e.splice(O,0,g)})}return c=c.concat(x),st(this,"exportData",{dataRows:c}),c}function ct(t){var r=function(o){if(!o.tagName||o.tagName==="#text")return o.textContent||"";var i=o.attributes,l="<".concat(o.tagName);return i&&Object.keys(i).forEach(function(n){var x=i[n];l+=" ".concat(n,'="').concat(x,'"')}),l+=">",l+=o.textContent||"",(o.children||[]).forEach(function(n){l+=r(n)}),l+="</".concat(o.tagName,">")};return t=this.getTableAST(t),r(t)}function ft(t){var r=0,o=[],i=this.options,l=t?1.1 .toLocaleString()[1]:".",n=U(i.exporting.useMultiLevelHeaders,!0);t=this.getDataRows(n);var x=n?t.shift():null,D=t.shift(),v=function(L,h,w,k){var p=U(k,"");return h="highcharts-text"+(h?" "+h:""),typeof p=="number"?(p=p.toString(),l===","&&(p=p.replace(".",l)),h="highcharts-number"):k||(h="highcharts-empty"),w=ut({class:h},w),{tagName:L,attributes:w,textContent:p}};i.exporting.tableCaption!==!1&&o.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:U(i.exporting.tableCaption,i.title.text?i.title.text:"Chart")});for(var c=0,B=t.length;c<B;++c)t[c].length>r&&(r=t[c].length);o.push(function(L,h,w){var k=[],p=0;w=w||h&&h.length;var j=0,u;if(u=n&&L&&h){t:if(u=L.length,h.length===u){for(;u--;)if(L[u]!==h[u]){u=!1;break t}u=!0}else u=!1;u=!u}if(u){for(u=[];p<w;++p){var O=L[p],A=L[p+1];O===A?++j:j?(u.push(v("th","highcharts-table-topheading",{scope:"col",colspan:j+1},O)),j=0):(O===h[p]?i.exporting.useRowspanHeaders?(A=2,delete h[p]):(A=1,h[p]=""):A=1,O=v("th","highcharts-table-topheading",{scope:"col"},O),1<A&&O.attributes&&(O.attributes.valign="top",O.attributes.rowspan=A),u.push(O))}k.push({tagName:"tr",children:u})}if(h){for(u=[],p=0,w=h.length;p<w;++p)typeof h[p]<"u"&&u.push(v("th",null,{scope:"col"},h[p]));k.push({tagName:"tr",children:u})}return{tagName:"thead",children:k}}(x,D,Math.max(r,D.length)));var nt=[];return t.forEach(function(L){for(var h=[],w=0;w<r;w++)h.push(v(w?"td":"th",null,w?{}:{scope:"row"},L[w]));nt.push({tagName:"tr",children:h})}),o.push({tagName:"tbody",children:nt}),o={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:o}},st(this,"aftergetTableAST",o),o.tree}function xt(){this.toggleDataTable(!1)}function gt(t){var r=(t=U(t,!this.isDataTableVisible))&&!this.dataTableDiv;if(r&&(this.dataTableDiv=Dt.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){var o=this.dataTableDiv.style,i=o.display;o.display=t?"block":"none",t&&(this.dataTableDiv.innerHTML=f.emptyHTML,new f([this.getTableAST()]).addToDOM(this.dataTableDiv),st(this,"afterViewData",{element:this.dataTableDiv,wasHidden:r||i!==o.display}))}this.isDataTableVisible=t,r=this.exportDivElements,i=(o=this.options.exporting)&&o.buttons&&o.buttons.contextButton.menuItems,t=this.options.lang,o&&o.menuItemDefinitions&&t&&t.viewData&&t.hideData&&i&&r&&(r=r[i.indexOf("viewData")])&&f.setElementHTML(r,this.isDataTableVisible?t.hideData:t.viewData)}function mt(){this.toggleDataTable(!0)}function dt(t,r){var o=V.navigator,i=-1<o.userAgent.indexOf("WebKit")&&0>o.userAgent.indexOf("Chrome"),l=V.URL||V.webkitURL||V;try{if(o.msSaveOrOpenBlob&&V.MSBlobBuilder){var n=new V.MSBlobBuilder;return n.append(t),n.getBlob("image/svg+xml")}if(!i)return l.createObjectURL(new V.Blob(["\uFEFF"+t],{type:r}))}catch{}}function vt(){var t=this,r=t.dataTableDiv,o=function(l,n){return function(x,D){var v=(n?x:D).children[l].textContent;return x=(n?D:x).children[l].textContent,v===""||x===""||isNaN(v)||isNaN(x)?v.toString().localeCompare(x):v-x}};if(r&&t.options.exporting&&t.options.exporting.allowTableSorting){var i=r.querySelector("thead tr");i&&i.childNodes.forEach(function(l){var n=l.closest("table");l.addEventListener("click",function(){var x=Y([],r.querySelectorAll("tr:not(thead tr)"),!0),D=Y([],l.parentNode.children,!0);x.sort(o(D.indexOf(l),t.ascendingOrderInTable=!t.ascendingOrderInTable)).forEach(function(v){n.appendChild(v)}),D.forEach(function(v){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(c){v.classList.contains(c)&&v.classList.remove(c)})}),l.classList.add(t.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function yt(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}var Y=this&&this.__spreadArray||function(t,r,o){if(o||arguments.length===2)for(var i=0,l=r.length,n;i<l;i++)!n&&i in r||(n||(n=Array.prototype.slice.call(r,0,i)),n[i]=r[i]);return t.concat(n||Array.prototype.slice.call(r))},Dt=a.doc,V=a.win,wt=M.getOptions,rt=M.setOptions,ht=z.downloadURL,bt=_.series;a=_.seriesTypes;var Z=a.arearange,$=a.gantt,J=a.map,tt=a.mapbubble,et=a.treemap,pt=s.addEvent,at=s.defined,ut=s.extend,Tt=s.find,st=s.fireEvent,Et=s.isNumber,U=s.pick,T=[];return{compose:function(t){T.indexOf(t)===-1&&(T.push(t),pt(t,"afterViewData",vt),pt(t,"render",yt),t=t.prototype,t.downloadCSV=P,t.downloadXLS=E,t.getCSV=S,t.getDataRows=Q,t.getTable=ct,t.getTableAST=ft,t.hideData=xt,t.toggleDataTable=gt,t.viewData=mt),T.indexOf(rt)===-1&&(T.push(rt),(t=wt().exporting)&&(ut(t.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),t.buttons&&t.buttons.contextButton.menuItems&&t.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),rt(b)),Z&&T.indexOf(Z)===-1&&(T.push(Z),Z.prototype.keyToAxis={low:"y",high:"y"}),$&&T.indexOf($)===-1&&(T.push($),$.prototype.keyToAxis={start:"x",end:"x"}),J&&T.indexOf(J)===-1&&(T.push(J),J.prototype.exportKey="name"),tt&&T.indexOf(tt)===-1&&(T.push(tt),tt.prototype.exportKey="name"),et&&T.indexOf(et)===-1&&(T.push(et),et.prototype.exportKey="name")}}}),I(d,"masters/modules/export-data.src.js",[d["Core/Globals.js"],d["Extensions/ExportData/ExportData.js"]],function(f,b){b.compose(f.Chart)})})})(Ot);const At=it,Ct=St({__proto__:null,default:At},[it]);export{Ct as e};
