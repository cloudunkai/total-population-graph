function L(U,r){for(var F=0;F<r.length;F++){const g=r[F];if(typeof g!="string"&&!Array.isArray(g)){for(const f in g)if(f!=="default"&&!(f in U)){const v=Object.getOwnPropertyDescriptor(g,f);v&&Object.defineProperty(U,f,v.get?v:{enumerable:!0,get:()=>g[f]})}}}return Object.freeze(Object.defineProperty(U,Symbol.toStringTag,{value:"Module"}))}var R={},$={get exports(){return R},set exports(U){R=U}};(function(U){(function(r){U.exports?(r.default=r,U.exports=r):r(typeof Highcharts<"u"?Highcharts:void 0)})(function(r){function F(g,f,v,S){g.hasOwnProperty(f)||(g[f]=S.apply(null,v),typeof CustomEvent=="function"&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:f,module:g[f]}})))}r=r?r._modules:{},F(r,"Extensions/Sonification/MusicalFrequencies.js",[],function(){return[16.351597831287414,17.323914436054505,18.354047994837977,19.445436482630058,20.601722307054366,21.826764464562746,23.12465141947715,24.499714748859326,25.956543598746574,27.5,29.13523509488062,30.86770632850775,32.70319566257483,34.64782887210901,36.70809598967594,38.890872965260115,41.20344461410875,43.653528929125486,46.2493028389543,48.999429497718666,51.91308719749314,55,58.27047018976124,61.7354126570155,65.40639132514966,69.29565774421802,73.41619197935188,77.78174593052023,82.4068892282175,87.30705785825097,92.4986056779086,97.99885899543733,103.82617439498628,110,116.54094037952248,123.47082531403103,130.8127826502993,138.59131548843604,146.8323839587038,155.56349186104046,164.81377845643496,174.61411571650194,184.9972113558172,195.99771799087463,207.65234878997256,220,233.08188075904496,246.94165062806206,261.6255653005986,277.1826309768721,293.6647679174076,311.1269837220809,329.6275569128699,349.2282314330039,369.9944227116344,391.99543598174927,415.3046975799451,440,466.1637615180899,493.8833012561241,523.2511306011972,554.3652619537442,587.3295358348151,622.2539674441618,659.2551138257398,698.4564628660078,739.9888454232688,783.9908719634985,830.6093951598903,880,932.3275230361799,987.7666025122483,1046.5022612023945,1108.7305239074883,1174.6590716696303,1244.5079348883237,1318.5102276514797,1396.9129257320155,1479.9776908465376,1567.981743926997,1661.2187903197805,1760,1864.6550460723597,1975.533205024496,2093.004522404789,2217.4610478149766,2349.31814333926,2489.0158697766474,2637.02045530296,2793.825851464031,2959.955381693075,3135.9634878539946,3322.437580639561,3520,3729.3100921447194,3951.066410048992,4186.009044809578]}),F(r,"Extensions/Sonification/SignalHandler.js",[],function(){return function(){function g(f){this.supportedSignals=this.signals=void 0,this.init(f||[])}return g.prototype.init=function(f){this.supportedSignals=f,this.signals={}},g.prototype.registerSignalCallbacks=function(f){var v=this;v.supportedSignals.forEach(function(S){var E=f[S];E&&(v.signals[S]=v.signals[S]||[]).push(E)})},g.prototype.clearSignalCallbacks=function(f){var v=this;f?f.forEach(function(S){v.signals[S]&&delete v.signals[S]}):v.signals={}},g.prototype.emitSignal=function(f,v){var S;return this.signals[f]&&this.signals[f].forEach(function(E){E=E(v),S=typeof E<"u"?E:S}),S},g}()}),F(r,"Extensions/Sonification/SonificationUtilities.js",[r["Extensions/Sonification/MusicalFrequencies.js"],r["Extensions/Sonification/SignalHandler.js"],r["Core/Utilities.js"]],function(g,f,v){var S=v.clamp,E=v.merge,h={musicalFrequencies:g,SignalHandler:f,getExtremesForInstrumentProps:function(n,i,c){var x=n.options.sonification&&n.options.sonification.defaultInstrumentOptions,o=function(e){return{instrumentMapping:e.mapping}},s=(i||[]).slice(0);return x&&s.push(o(x)),n.series.forEach(function(e){(e=e.options.sonification&&e.options.sonification.instruments)&&(s=s.concat(e.map(o)))}),s.reduce(function(e,a){return Object.keys(a.instrumentMapping||{}).forEach(function(u){u=a.instrumentMapping[u],typeof u!="string"||e[u]||(e[u]=h.calculateDataExtremes(n,u))}),e},E(c))},getMusicalScale:function(n){return g.filter(function(i,c){var x=c%12+1;return n.some(function(o){return o===x})})},calculateDataExtremes:function(n,i){return n.series.reduce(function(c,x){return x.points.forEach(function(o){o=typeof o[i]<"u"?o[i]:o.options[i],c.min=Math.min(c.min,o),c.max=Math.max(c.max,o)}),c},{min:1/0,max:-1/0})},virtualAxisTranslate:function(n,i,c,x){var o=i.max-i.min;return n=c.min+Math.abs(c.max-c.min)*(x?i.max-n:n-i.min)/o,0<o?S(n,c.min,c.max):c.min}};return h}),F(r,"Extensions/Sonification/Options.js",[],function(){return{sonification:{enabled:!1,duration:2500,afterSeriesWait:700,masterVolume:1,order:"sequential",defaultInstrumentOptions:{instrument:"sineMusical",minFrequency:392,maxFrequency:1046,mapping:{pointPlayTime:"x",duration:200,frequency:"y"}}}}}),F(r,"Extensions/Sonification/Sonification.js",[r["Core/Defaults.js"],r["Core/Utilities.js"],r["Extensions/Sonification/SonificationUtilities.js"],r["Extensions/Sonification/Options.js"]],function(g,f,v,S){return f=f.merge,f(!0,g.defaultOptions,S),g={fadeOutDuration:20,utilities:v},g}),F(r,"Extensions/Sonification/Instrument.js",[r["Core/Globals.js"],r["Extensions/Sonification/Sonification.js"],r["Extensions/Sonification/SonificationUtilities.js"],r["Core/Utilities.js"]],function(g,f,v,S){var E=g.win,h=S.error,n=S.merge,i=S.pick,c=S.uniqueKey,x=function(){function o(s){this.playCallbackTimers=this.options=this.masterVolume=this.id=void 0,this.init(s)}return o.prototype.init=function(s){if(this.initAudioContext()){this.options=n(o.defaultOptions,s),this.id=this.options.id=s&&s.id||c(),this.masterVolume=this.options.masterVolume||0,s=o.audioContext;var e=this.destinationNode||s.destination;this.gainNode=s.createGain(),this.setGain(0),(this.panNode=s.createStereoPanner&&s.createStereoPanner())?(this.setPan(0),this.gainNode.connect(this.panNode),this.panNode.connect(e)):this.gainNode.connect(e),this.options.type==="oscillator"&&this.initOscillator(this.options.oscillator),this.playCallbackTimers=[]}else h(29)},o.prototype.copy=function(s){return new o(n(this.options,{id:null},s))},o.prototype.initAudioContext=function(){var s=E.AudioContext||E.webkitAudioContext,e=!!o.audioContext;return s?(o.audioContext=o.audioContext||new s,!e&&o.audioContext&&o.audioContext.state==="running"&&o.audioContext.suspend(),!!(o.audioContext&&o.audioContext.createOscillator&&o.audioContext.createGain)):!1},o.prototype.initOscillator=function(s){this.oscillator=o.audioContext.createOscillator(),this.oscillator.type=s.waveformShape,this.oscillator.connect(this.gainNode),this.oscillatorStarted=!1},o.prototype.setPan=function(s){this.panNode&&this.panNode.pan.setValueAtTime(s,o.audioContext.currentTime)},o.prototype.setGain=function(s,e){var a=this.gainNode;s*=this.masterVolume,a&&(1.2<s&&(console.warn("Highcharts sonification warning: Volume of instrument set too high."),s=1.2),e?(a.gain.setValueAtTime(a.gain.value,o.audioContext.currentTime),a.gain.linearRampToValueAtTime(s,o.audioContext.currentTime+e/1e3)):a.gain.setValueAtTime(s,o.audioContext.currentTime))},o.prototype.cancelGainRamp=function(){this.gainNode&&this.gainNode.gain.cancelScheduledValues(0)},o.prototype.setMasterVolume=function(s){this.masterVolume=s||0},o.prototype.getValidFrequency=function(s,e,a){var u=this.options.allowedFrequencies,O=i(a,1/0),j=i(e,-1/0);return u&&u.length?u.reduce(function(w,k){return Math.abs(k-s)<Math.abs(w-s)&&k<O&&k>j?k:w},1/0):s},o.prototype.clearPlayCallbackTimers=function(){this.playCallbackTimers.forEach(function(s){clearInterval(s)}),this.playCallbackTimers=[]},o.prototype.setFrequency=function(s,e){e=e||{},s=this.getValidFrequency(s,e.min,e.max),this.options.type==="oscillator"&&this.oscillatorPlay(s)},o.prototype.oscillatorPlay=function(s){this.oscillatorStarted||(this.oscillator.start(),this.oscillatorStarted=!0),this.oscillator.frequency.setValueAtTime(s,o.audioContext.currentTime)},o.prototype.preparePlay=function(){this.setGain(.001),o.audioContext.state==="suspended"&&o.audioContext.resume(),this.oscillator&&!this.oscillatorStarted&&(this.oscillator.start(),this.oscillatorStarted=!0)},o.prototype.play=function(s){var e=this,a=s.duration||0,u=function(w,k,T){var H=s.duration,D=e.options.playCallbackInterval,I=0;if(typeof w=="function"){var A=setInterval(function(){I++;var N=I*D/H;1<=N?(e[k](w(1),T),clearInterval(A)):e[k](w(N),T)},D);e.playCallbackTimers.push(A)}else e[k](w,T)};if(e.id)if(o.audioContext.state==="suspended"||this.oscillator&&!this.oscillatorStarted)e.preparePlay(),setTimeout(function(){e.play(s)},10);else{e.playCallbackTimers.length&&e.clearPlayCallbackTimers(),e.cancelGainRamp(),e.stopOscillatorTimeout&&(clearTimeout(e.stopOscillatorTimeout),delete e.stopOscillatorTimeout),e.stopTimeout&&(clearTimeout(e.stopTimeout),delete e.stopTimeout,e.stopCallback&&(e._play=e.play,e.play=function(){},e.stopCallback("cancelled"),e.play=e._play));var O=a<f.fadeOutDuration+20;e.stopCallback=s.onEnd;var j=function(){delete e.stopTimeout,e.stop(O)};a?(e.stopTimeout=setTimeout(j,O?a:a-f.fadeOutDuration),u(s.frequency,"setFrequency",{minFrequency:s.minFrequency,maxFrequency:s.maxFrequency}),u(i(s.volume,1),"setGain",4),u(i(s.pan,0),"setPan")):j()}},o.prototype.mute=function(){this.setGain(1e-4,.8*f.fadeOutDuration)},o.prototype.stop=function(s,e,a){var u=this,O=function(){if(u.stopOscillatorTimeout&&delete u.stopOscillatorTimeout,u.oscillator&&u.options.oscillator){try{u.oscillator.stop()}catch{}u.gainNode&&u.oscillator.disconnect(u.gainNode),u.initOscillator(u.options.oscillator)}e&&e(a),u.stopCallback&&u.stopCallback(a)};u.playCallbackTimers.length&&u.clearPlayCallbackTimers(),u.stopTimeout&&clearTimeout(u.stopTimeout),s?(u.setGain(0),O()):(u.mute(),u.stopOscillatorTimeout=setTimeout(O,f.fadeOutDuration+100))},o.defaultOptions={type:"oscillator",playCallbackInterval:20,masterVolume:1,oscillator:{waveformShape:"sine"}},o.definitions={},o}();return["sine","square","triangle","sawtooth"].forEach(function(o){x.definitions[o]=new x({oscillator:{waveformShape:o}}),x.definitions[o+"Musical"]=new x({allowedFrequencies:v.musicalFrequencies,oscillator:{waveformShape:o}}),x.definitions[o+"Major"]=new x({allowedFrequencies:v.getMusicalScale([1,3,5,6,8,10,12]),oscillator:{waveformShape:o}})}),x}),F(r,"Extensions/Sonification/Earcon.js",[r["Extensions/Sonification/Instrument.js"],r["Core/Utilities.js"]],function(g,f){var v=f.error,S=f.merge,E=f.pick,h=f.uniqueKey;return f=function(){function n(i){this.options=this.instrumentsPlaying=this.id=void 0,this.init(i||{})}return n.prototype.init=function(i){this.options=i,this.options.id||(this.options.id=this.id=h()),this.instrumentsPlaying={}},n.prototype.sonify=function(i){var c=S(this.options,i),x=E(c.volume,1),o=c.pan,s=this,e=i&&i.onEnd,a=s.options.onEnd;c.instruments.forEach(function(u){var O=typeof u.instrument=="string"?g.definitions[u.instrument]:u.instrument,j=S(u.playOptions),w="";if(O&&O.play){if(u.playOptions){j.pan=E(o,j.pan);var k=j.onEnd;j.onEnd=function(){delete s.instrumentsPlaying[w],k&&k.apply(this,arguments),Object.keys(s.instrumentsPlaying).length||(e&&e.apply(this,arguments),a&&a.apply(this,arguments))},u=O.copy(),u.setMasterVolume(x),w=u.id,s.instrumentsPlaying[w]=u,u.play(j)}}else v(30)})},n.prototype.cancelSonify=function(i){var c=this.instrumentsPlaying,x=c&&Object.keys(c);x&&x.length&&(x.forEach(function(o){c[o].stop(!i,null,"cancelled")}),this.instrumentsPlaying={})},n}(),f}),F(r,"Extensions/Sonification/Timeline.js",[r["Extensions/Sonification/Sonification.js"],r["Core/Utilities.js"],r["Extensions/Sonification/SonificationUtilities.js"]],function(g,f,v){var S=f.merge,E=f.splat;return f=function(){function h(n){this.signalHandler=this.pathsPlaying=this.paths=this.options=this.cursor=void 0,this.init(n||{})}return h.prototype.init=function(n){this.options=n,this.cursor=0,this.paths=n.paths||[],this.pathsPlaying={},this.signalHandler=new v.SignalHandler(["playOnEnd","masterOnEnd","onPathStart","onPathEnd"]),this.signalHandler.registerSignalCallbacks(S(n,{masterOnEnd:n.onEnd}))},h.prototype.play=function(n){this.pause(),this.signalHandler.clearSignalCallbacks(["playOnEnd"]),this.signalHandler.registerSignalCallbacks({playOnEnd:n}),this.playPaths(1)},h.prototype.rewind=function(n){this.pause(),this.signalHandler.clearSignalCallbacks(["playOnEnd"]),this.signalHandler.registerSignalCallbacks({playOnEnd:n}),this.playPaths(-1)},h.prototype.playPaths=function(n){var i=this,c=i.signalHandler;if(i.paths.length){var x=E(this.paths[this.cursor]),o=this.paths[this.cursor+n],s=function(a){c.emitSignal("onPathStart",a),i.pathsPlaying[a.id]=a,a[0<n?"play":"rewind"](function(u){u=u&&u.cancelled;var O={path:a,cancelled:u};delete i.pathsPlaying[a.id],c.emitSignal("onPathEnd",O);var j=0;j++,j>=x.length&&(o&&!u?(i.cursor+=n,E(o).forEach(function(w){w[0<n?"resetCursor":"resetCursorEnd"]()}),i.playPaths(n)):(c.emitSignal("playOnEnd",O),c.emitSignal("masterOnEnd",O)))})};x.forEach(function(a){a&&(a.timeline=i,setTimeout(function(){s(a)},g.fadeOutDuration))})}else{var e={cancelled:!1};c.emitSignal("playOnEnd",e),c.emitSignal("masterOnEnd",e)}},h.prototype.pause=function(n){var i=this;Object.keys(i.pathsPlaying).forEach(function(c){i.pathsPlaying[c]&&i.pathsPlaying[c].pause(n)}),i.pathsPlaying={}},h.prototype.resetCursor=function(){this.paths.forEach(function(n){E(n).forEach(function(i){i.resetCursor()})}),this.cursor=0},h.prototype.resetCursorEnd=function(){this.paths.forEach(function(n){E(n).forEach(function(i){i.resetCursorEnd()})}),this.cursor=this.paths.length-1},h.prototype.setCursor=function(n){return this.paths.some(function(i){return E(i).some(function(c){return c.setCursor(n)})})},h.prototype.getCursor=function(){return this.getCurrentPlayingPaths().reduce(function(n,i){return n[i.id]=i.getCursor(),n},{})},h.prototype.atStart=function(){return this.cursor?!1:!E(this.paths[0]).some(function(n){return n.cursor})},h.prototype.getCurrentPlayingPaths=function(){return this.paths.length?E(this.paths[this.cursor]):[]},h}(),f}),F(r,"Extensions/Sonification/TimelineEvent.js",[r["Core/Utilities.js"]],function(g){var f=g.merge,v=g.uniqueKey;return g=function(){function S(E){this.time=this.options=this.id=void 0,this.init(E)}return S.prototype.init=function(E){this.options=E,this.time=E.time||0,this.id=this.options.id=E.id||v()},S.prototype.play=function(E){var h=this.options.eventObject,n=this.options.onEnd,i=E&&E.onEnd,c=this.options.playOptions&&this.options.playOptions.onEnd;E=f(this.options.playOptions,E),h&&h.sonify?(E.onEnd=n||i||c?function(){var x=arguments;[n,i,c].forEach(function(o){o&&o.apply(this,x)})}:void 0,h.sonify(E)):(i&&i(),n&&n())},S.prototype.cancel=function(E){var h=this.options.eventObject;h&&h.cancelSonify(E)},S}(),g}),F(r,"Extensions/Sonification/TimelinePath.js",[r["Extensions/Sonification/TimelineEvent.js"],r["Extensions/Sonification/SonificationUtilities.js"],r["Core/Utilities.js"]],function(g,f,v){var S=v.merge,E=v.uniqueKey;return v=function(){function h(n){this.signalHandler=this.options=this.id=this.eventsPlaying=this.eventIdMap=this.events=this.cursor=void 0,this.init(n)}return h.prototype.init=function(n){this.options=n,this.id=this.options.id=n.id||E(),this.cursor=0,this.eventsPlaying={},this.events=n.silentWait?[new g({time:0}),new g({time:n.silentWait})]:this.options.events,this.targetDuration=n.targetDuration||n.silentWait,this.sortEvents(),this.updateEventIdMap(),this.signalHandler=new f.SignalHandler(["playOnEnd","masterOnEnd","onStart","onEventStart","onEventEnd"]),this.signalHandler.registerSignalCallbacks(S(n,{masterOnEnd:n.onEnd}))},h.prototype.sortEvents=function(){this.events=this.events.sort(function(n,i){return n.time-i.time})},h.prototype.updateEventIdMap=function(){this.eventIdMap=this.events.reduce(function(n,i,c){return n[i.id]=c,n},{})},h.prototype.addTimelineEvents=function(n){this.events=this.events.concat(n),this.sortEvents(),this.updateEventIdMap()},h.prototype.getCursor=function(){return this.events[this.cursor]},h.prototype.setCursor=function(n){return n=this.eventIdMap[n],typeof n<"u"?(this.cursor=n,!0):!1},h.prototype.play=function(n){this.pause(),this.signalHandler.emitSignal("onStart"),this.signalHandler.clearSignalCallbacks(["playOnEnd"]),this.signalHandler.registerSignalCallbacks({playOnEnd:n}),this.playEvents(1)},h.prototype.rewind=function(n){this.pause(),this.signalHandler.emitSignal("onStart"),this.signalHandler.clearSignalCallbacks(["playOnEnd"]),this.signalHandler.registerSignalCallbacks({playOnEnd:n}),this.playEvents(-1)},h.prototype.resetCursor=function(){this.cursor=0},h.prototype.resetCursorEnd=function(){this.cursor=this.events.length-1},h.prototype.pause=function(n){var i=this;clearTimeout(i.nextScheduledPlay),Object.keys(i.eventsPlaying).forEach(function(c){i.eventsPlaying[c]&&i.eventsPlaying[c].cancel(n)}),i.eventsPlaying={}},h.prototype.playEvents=function(n){var i=this,c=i.events[this.cursor],x=i.events[this.cursor+n],o=function(e){i.signalHandler.emitSignal("masterOnEnd",e),i.signalHandler.emitSignal("playOnEnd",e)};if(c.timelinePath=i,i.signalHandler.emitSignal("onEventStart",c)===!1)o({event:c,cancelled:!0});else if(i.eventsPlaying[c.id]=c,c.play({onEnd:function(e){e={event:c,cancelled:!!e},delete i.eventsPlaying[c.id],i.signalHandler.emitSignal("onEventEnd",e),x||o(e)}}),x){var s=Math.abs(x.time-c.time);1>s?(i.cursor+=n,i.playEvents(n)):this.nextScheduledPlay=setTimeout(function(){i.cursor+=n,i.playEvents(n)},s)}},h}(),v}),F(r,"Extensions/Sonification/SeriesSonify.js",[r["Extensions/Sonification/Earcon.js"],r["Extensions/Sonification/Instrument.js"],r["Core/Series/Point.js"],r["Extensions/Sonification/SonificationUtilities.js"],r["Extensions/Sonification/Timeline.js"],r["Extensions/Sonification/TimelineEvent.js"],r["Extensions/Sonification/TimelinePath.js"],r["Core/Utilities.js"]],function(g,f,v,S,E,h,n,i){var c=S.getExtremesForInstrumentProps,x=S.virtualAxisTranslate,o=i.extend,s=i.find,e=i.isArray,a=i.merge,u=i.objectEach,O=i.pick,j;return function(w){function k(y,p){return y.forEach(function(m){m=m.instrument,typeof m!="string"&&m.setMasterVolume(p)}),y}function T(y,p){var m=p.timeExtremes||W(y,p.pointPlayTime),t=c(y.chart,p.instruments,p.dataExtremes),l=D(y,p.instruments,t),d=O(p.masterVolume,1),P=z(p.instruments),M=k(P,d);return P=y.points.reduce(function(C,V){var q=I(V,p.earcons||[]),G=x(A(V,p.pointPlayTime),m,{min:0,max:Math.max(p.duration-l,10)});return C.concat(new h({eventObject:V,time:G,id:V.id,playOptions:{instruments:M,dataExtremes:t,masterVolume:d}}),q.map(function(K){return new h({eventObject:K,time:G,playOptions:{volume:d}})}))},[]),new n({events:P,onStart:function(){p.onStart&&p.onStart(y)},onEventStart:function(C){var V=C.options&&C.options.eventObject;if(V instanceof v){if(!V.series.visible&&!V.series.chart.series.some(function(q){return q.visible}))return C.timelinePath.timeline.pause(),C.timelinePath.timeline.resetCursor(),!1;p.onPointStart&&p.onPointStart(C,V)}},onEventEnd:function(C){var V=C.event&&C.event.options&&C.event.options.eventObject;V instanceof v&&p.onPointEnd&&p.onPointEnd(C.event,V)},onEnd:function(){p.onEnd&&p.onEnd(y)},targetDuration:p.duration})}function H(y){var p=y.options.sonification||{},m=y.chart.options.sonification||{},t=m.events||{},l=p.events||{};return{onEnd:l.onSeriesEnd||t.onSeriesEnd,onStart:l.onSeriesStart||t.onSeriesStart,onPointEnd:l.onPointEnd||t.onPointEnd,onPointStart:l.onPointStart||t.onPointStart,pointPlayTime:m.defaultInstrumentOptions&&m.defaultInstrumentOptions.mapping&&m.defaultInstrumentOptions.mapping.pointPlayTime,masterVolume:m.masterVolume,instruments:N(y),earcons:p.earcons||m.earcons}}function D(y,p,m){var t=y.points[y.points.length-1];return p.reduce(function(l,d){return d=d.instrumentMapping.duration,d=typeof d=="string"?0:typeof d=="function"?d(t,m):d,Math.max(l,d)},0)}function I(y,p){return p.reduce(function(m,t){var l=t.earcon;return t.condition?(t=t.condition(y),t instanceof g?m.push(t):t&&m.push(l)):t.onPoint&&y.id===t.onPoint&&m.push(l),m},[])}function A(y,p){return typeof p=="function"?p(y):O(y[p],y.options[p])}function N(y,p){if(p&&p.instruments)return p.instruments;var m=y.chart.options.sonification&&y.chart.options.sonification.defaultInstrumentOptions||{},t=function(l){u(l,function(d,P){d===null&&delete l[P]})};return(y.options.sonification&&y.options.sonification.instruments||[{}]).map(function(l){return t(l.mapping||{}),t(l),{instrument:l.instrument||m.instrument,instrumentOptions:a(m,l,{mapping:void 0,instrument:void 0}),instrumentMapping:a(m.mapping,l.mapping)}})}function W(y,p){return y.points.reduce(function(m,t){return t=A(t,p),m.min=Math.min(m.min,t),m.max=Math.max(m.max,t),m},{min:1/0,max:-1/0})}function z(y){return y.map(function(p){var m=p.instrument;return m=(typeof m=="string"?f.definitions[m]:m).copy(),a(p,{instrument:m})})}function B(y){var p=this.chart.options.sonification,m=this.options.sonification;y=a({duration:m&&m.duration||p&&p.duration},H(this),y),p=T(this,y),(m=this.chart.sonification)&&(m.timeline&&m.timeline.pause(),m.duration=y.duration,m.timeline=new E({paths:[p]}),m.timeline.play())}var _=[];w.compose=function(y){return _.indexOf(y)===-1&&(_.push(y),o(y.prototype,{sonify:B})),y},w.buildChartSonifySeriesOptions=function(y,p,m){var t=m.seriesOptions||{},l=y.chart.options.sonification;l=l&&l.defaultInstrumentOptions&&l.defaultInstrumentOptions.mapping&&l.defaultInstrumentOptions.mapping.pointPlayTime||"x";var d=H(y);return a(d,{dataExtremes:p,timeExtremes:W(y,l),instruments:m.instruments||d.instruments,onStart:m.onSeriesStart||d.onStart,onEnd:m.onSeriesEnd||d.onEnd,earcons:m.earcons||d.earcons,masterVolume:O(m.masterVolume,d.masterVolume)},e(t)?s(t,function(P){return P.id===O(y.id,y.options.id)})||{}:t,{pointPlayTime:l})},w.buildTimelinePathFromSeries=T}(j||(j={})),j}),F(r,"Extensions/Sonification/ChartSonify.js",[r["Extensions/Sonification/Earcon.js"],r["Core/Series/Point.js"],r["Extensions/Sonification/SeriesSonify.js"],r["Extensions/Sonification/SonificationUtilities.js"],r["Extensions/Sonification/Timeline.js"],r["Extensions/Sonification/TimelineEvent.js"],r["Extensions/Sonification/TimelinePath.js"],r["Core/Utilities.js"]],function(g,f,v,S,E,h,n,i){function c(t,l,d){if(t==="sequential"||t==="simultaneous"){var P=l.series.reduce(function(M,C){return C.visible&&(C.options.sonification&&C.options.sonification.enabled)!==!1&&M.push({series:C,seriesOptions:d(C)}),M},[]);t==="simultaneous"&&(P=[P])}else P=t.reduce(function(M,C){return C=p(C).reduce(function(V,q){var G;if(typeof q=="string"){var K=l.get(q);K.visible&&(G={series:K,seriesOptions:d(K)})}else q instanceof g&&(G=new n({events:[new h({eventObject:q})]}));return q.silentWait&&(G=new n({silentWait:q.silentWait})),G&&V.push(G),V},[]),C.length&&M.push(C),M},[]);return P}function x(t,l){return l?t.reduce(function(d,P,M){return P=p(P),d.push(P),M<t.length-1&&P.some(function(C){return C.series})&&d.push(new n({silentWait:l})),d},[]):t}function o(t){return t.reduce(function(l,d){return d=p(d),l+(d.length===1&&d[0].options&&d[0].options.silentWait||0)},0)}function s(t){var l=t.reduce(function(d,P){return(P=P.events)&&P.length&&(d.min=Math.min(P[0].time,d.min),d.max=Math.max(P[P.length-1].time,d.max)),d},{min:1/0,max:-1/0});t.forEach(function(d){var P=d.events,M=P&&P.length,C=[];M&&P[0].time<=l.min||C.push(new h({time:l.min})),M&&P[P.length-1].time>=l.max||C.push(new h({time:l.max})),C.length&&d.addTimelineEvents(C)})}function e(t){return t.reduce(function(l,d){return l+p(d).reduce(function(P,M){return(M=M.series&&M.seriesOptions&&M.seriesOptions.timeExtremes)?Math.max(P,M.max-M.min):P},0)},0)}function a(t,l){var d=Math.max(l-o(t),0),P=e(t);return t.reduce(function(M,C){return C=p(C).reduce(function(V,q){return q instanceof n?V.push(q):q.series&&(q.seriesOptions.duration=q.seriesOptions.duration||W(q.seriesOptions.timeExtremes.max-q.seriesOptions.timeExtremes.min,{min:0,max:P},{min:0,max:d}),V.push(v.buildTimelinePathFromSeries(q.series,q.seriesOptions))),V},[]),M.push(C),M},[])}function u(t,l){return t=t.options.sonification||{},_({duration:t.duration,afterSeriesWait:t.afterSeriesWait,pointPlayTime:t.defaultInstrumentOptions&&t.defaultInstrumentOptions.mapping&&t.defaultInstrumentOptions.mapping.pointPlayTime,order:t.order,onSeriesStart:t.events&&t.events.onSeriesStart,onSeriesEnd:t.events&&t.events.onSeriesEnd,onEnd:t.events&&t.events.onEnd},l)}function O(t){var l=u(this,t);this.sonification.timeline&&this.sonification.timeline.pause(),this.sonification.duration=l.duration;var d=N(this,l.instruments,l.dataExtremes);t=c(l.order,this,function(P){return v.buildChartSonifySeriesOptions(P,d,l)}),t=x(t,l.afterSeriesWait||0),t=a(t,l.duration),t.forEach(function(P){s(P)}),this.sonification.timeline=new E({paths:t,onEnd:l.onEnd}),this.sonification.timeline.play()}function j(){if(this.sonification.timeline){var t=this.sonification.timeline.getCursor();return Object.keys(t).map(function(l){return t[l].options.eventObject}).filter(function(l){return l instanceof f})}return[]}function w(t){var l=this.sonification.timeline;l&&p(t).forEach(function(d){l.setCursor(d.id)})}function k(t){this.sonification.timeline?this.sonification.timeline.pause(y(t,!0)):this.sonification.currentlyPlayingPoint&&this.sonification.currentlyPlayingPoint.cancelSonify(t)}function T(t){this.sonification.timeline&&this.sonification.timeline.play(t)}function H(t){this.sonification.timeline&&this.sonification.timeline.rewind(t)}function D(t){this.pauseSonify(t),this.resetSonifyCursor()}function I(){this.sonification.timeline&&this.sonification.timeline.resetCursor()}function A(){this.sonification.timeline&&this.sonification.timeline.resetCursorEnd()}var N=S.getExtremesForInstrumentProps,W=S.virtualAxisTranslate,z=i.addEvent,B=i.extend,_=i.merge,y=i.pick,p=i.splat,m=[];return S={chartSonify:O,compose:function(t){return m.indexOf(t)===-1&&(m.push(t),B(t.prototype,{sonify:O,pauseSonify:k,resumeSonify:T,rewindSonify:H,cancelSonify:D,getCurrentSonifyPoints:j,setSonifyCursor:w,resetSonifyCursor:I,resetSonifyCursorEnd:A}),z(t,"init",function(){this.sonification={}}),z(t,"update",function(l){(l=l.options.sonification)&&_(!0,this.options.sonification,l)})),t},pause:k,resume:T,rewind:H,cancel:D,getCurrentPoints:j,setCursor:w,resetCursor:I,resetCursorEnd:A},S}),F(r,"Extensions/Sonification/PointSonify.js",[r["Extensions/Sonification/Instrument.js"],r["Core/Utilities.js"],r["Extensions/Sonification/SonificationUtilities.js"]],function(g,f,v){var S=f.error,E=f.merge,h=f.pick,n=[],i={minDuration:20,maxDuration:2e3,minVolume:.1,maxVolume:1,minPan:-1,maxPan:1,minFrequency:220,maxFrequency:2200},c;return function(x){function o(e){var a=this,u=a.series.chart,O=h(e.masterVolume,u.options.sonification&&u.options.sonification.masterVolume),j=e.dataExtremes||{},w=function(T,H,D){if(typeof T=="function")return H?function(N){return T(a,j,N)}:T(a,j);if(typeof T=="string"){var I=(H=T.charAt(0)==="-")?T.slice(1):T,A=h(a[I],a.options[I]);return j[I]=j[I]||v.calculateDataExtremes(a.series.chart,I),v.virtualAxisTranslate(A,j[I],D,H)}return T};u.sonification.currentlyPlayingPoint=a,a.sonification=a.sonification||{},a.sonification.instrumentsPlaying=a.sonification.instrumentsPlaying||{};var k=a.sonification.signalHandler=a.sonification.signalHandler||new v.SignalHandler(["onEnd"]);k.clearSignalCallbacks(),k.registerSignalCallbacks({onEnd:e.onEnd}),!a.isNull&&a.visible&&a.series.visible?e.instruments.forEach(function(T){var H=typeof T.instrument=="string"?g.definitions[T.instrument]:T.instrument,D=T.instrumentMapping||{},I=E(i,T.instrumentOptions),A=H.id,N=function(W){T.onEnd&&T.onEnd.apply(this,arguments),u.sonification&&u.sonification.currentlyPlayingPoint&&delete u.sonification.currentlyPlayingPoint,a.sonification&&a.sonification.instrumentsPlaying&&(delete a.sonification.instrumentsPlaying[A],Object.keys(a.sonification.instrumentsPlaying).length||k.emitSignal("onEnd",W))};H&&H.play?(typeof O<"u"&&H.setMasterVolume(O),a.sonification.instrumentsPlaying[H.id]=H,H.play({frequency:w(D.frequency,!0,{min:I.minFrequency,max:I.maxFrequency}),duration:w(D.duration,!1,{min:I.minDuration,max:I.maxDuration}),pan:w(D.pan,!0,{min:I.minPan,max:I.maxPan}),volume:w(D.volume,!0,{min:I.minVolume,max:I.maxVolume}),onEnd:N,minFrequency:I.minFrequency,maxFrequency:I.maxFrequency})):S(30)}):k.emitSignal("onEnd")}function s(e){var a=this.sonification&&this.sonification.instrumentsPlaying,u=a&&Object.keys(a);u&&u.length&&(u.forEach(function(O){a[O].stop(!e,null,"cancelled")}),this.sonification.instrumentsPlaying={},this.sonification.signalHandler.emitSignal("onEnd","cancelled"))}x.compose=function(e){if(n.indexOf(e)===-1){n.push(e);var a=e.prototype;a.sonify=o,a.cancelSonify=s}return e}}(c||(c={})),c}),F(r,"masters/modules/sonification.src.js",[r["Core/Globals.js"],r["Extensions/Sonification/ChartSonify.js"],r["Extensions/Sonification/Earcon.js"],r["Extensions/Sonification/Instrument.js"],r["Extensions/Sonification/PointSonify.js"],r["Extensions/Sonification/SeriesSonify.js"],r["Extensions/Sonification/Sonification.js"],r["Extensions/Sonification/Timeline.js"],r["Extensions/Sonification/TimelineEvent.js"],r["Extensions/Sonification/TimelinePath.js"]],function(g,f,v,S,E,h,n,i,c,x){var o=this&&this.__assign||function(){return o=Object.assign||function(s){for(var e,a=1,u=arguments.length;a<u;a++){e=arguments[a];for(var O in e)Object.prototype.hasOwnProperty.call(e,O)&&(s[O]=e[O])}return s},o.apply(this,arguments)};g.sonification=o(o({},n),{instruments:S.definitions,Earcon:v,Instrument:S,Timeline:i,TimelineEvent:c,TimelinePath:x}),g.Earcon=v,g.Instrument=S,f.compose(g.Chart),h.compose(g.Series),E.compose(g.Point)})})})($);const J=R,Q=L({__proto__:null,default:J},[R]);export{Q as s};
